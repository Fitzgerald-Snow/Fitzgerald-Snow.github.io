<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research Admin - Content Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Pure static admin tool - no external dependencies -->
    <style>
        body {
            font-family: 'Times New Roman', Times, serif;
        }
        .admin-nav {
            position: sticky;
            top: 0;
            z-index: 50;
            background-color: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
        }
        .form-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        .input-field {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 0.5rem;
            transition: border-color 0.3s ease;
        }
        .input-field:focus {
            outline: none;
            border-color: #0ea5e9;
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #0ea5e9, #06b6d4);
            color: white;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px rgba(14, 165, 233, 0.3);
        }
        .preview-card {
            border: 2px dashed #cbd5e1;
            border-radius: 0.75rem;
            padding: 1.5rem;
            background-color: #f8fafc;
        }
        .tag-input {
            display: inline-block;
            background: #e2e8f0;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            margin: 0.25rem;
            font-size: 0.875rem;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <nav class="admin-nav shadow-lg">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <a href="research.html" class="text-xl font-bold text-white">← Back to Research</a>
                <span class="text-slate-400">|</span>
                <h1 class="text-xl font-semibold text-white">Content Admin</h1>
            </div>
            <div class="text-sm text-slate-300">
                Simplified content management for research articles & notes
            </div>
        </div>
    </nav>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-sm w-full mx-4">
            <h2 class="text-2xl font-bold mb-4 text-center">Admin Access</h2>
            <div class="mb-4">
                <label class="block text-sm font-semibold mb-2">Password:</label>
                <input type="password" id="adminPassword" class="input-field" placeholder="Enter admin password">
            </div>
            <button class="btn-primary w-full" onclick="checkPassword()">Login</button>
            <div id="loginError" class="text-red-500 text-sm mt-2 text-center" style="display: none;">
                Incorrect password. Please try again.
            </div>
        </div>
    </div>

    <main class="container mx-auto px-6 py-8" id="mainContent" style="display: none;">
        
        <!-- Content Type Selector -->
        <div class="mb-8">
            <div class="flex flex-wrap gap-4 justify-center">
                <button class="btn-primary tab-btn active" data-type="neuroscience">Neuroscience Article</button>
                <button class="btn-primary tab-btn" data-type="mathematics">Mathematics Article</button>
                <button class="btn-primary tab-btn" data-type="book">Book Note</button>
            </div>
        </div>

        <!-- Article Form -->
        <div id="article-form" class="form-section">
            <h2 class="text-2xl font-bold mb-6 text-center">Add New Content</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Form Fields -->
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-slate-700">Title</label>
                        <input type="text" id="title" class="input-field" placeholder="Enter article title">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2 text-slate-700">Description</label>
                        <textarea id="description" rows="4" class="input-field" placeholder="Brief description or abstract"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-slate-700">Content</label>
                        <textarea id="content" rows="12" class="input-field" placeholder="Write your article content here... You can use HTML tags for formatting."></textarea>
                        <div class="text-xs text-slate-500 mt-1">
                            Tip: Use HTML tags like &lt;h2&gt;, &lt;p&gt;, &lt;ul&gt;, &lt;blockquote&gt; for formatting
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2 text-slate-700">Tags (comma-separated)</label>
                        <input type="text" id="tags" class="input-field" placeholder="neural-networks, learning, review">
                        <div class="text-xs text-slate-500 mt-1">Available tags will appear as you type</div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2 text-slate-700">Image URL (optional)</label>
                        <input type="text" id="imageUrl" class="input-field" placeholder="https://example.com/image.jpg">
                    </div>

                    <!-- Book-specific fields -->
                    <div id="book-fields" class="space-y-4" style="display: none;">
                        <div>
                            <label class="block text-sm font-semibold mb-2 text-slate-700">Author</label>
                            <input type="text" id="author" class="input-field" placeholder="Author name">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2 text-slate-700">Reading Progress (%)</label>
                            <input type="number" id="progress" class="input-field" placeholder="25" min="0" max="100">
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <button class="btn-primary flex-1" onclick="generatePreview()">Preview</button>
                        <button class="btn-primary flex-1" onclick="generateCode()">Generate HTML</button>
                    </div>
                </div>

                <!-- Preview -->
                <div>
                    <label class="block text-sm font-semibold mb-2 text-slate-700">Preview</label>
                    <div id="preview" class="preview-card min-h-64">
                        <p class="text-slate-500 text-center">Fill in the form to see a preview</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generated Code -->
        <div id="code-section" class="form-section" style="display: none;">
            <h3 class="text-xl font-bold mb-4">Generated HTML Code</h3>
            <p class="text-slate-600 mb-4">Copy and paste this code into your research.html file:</p>
            <textarea id="generated-code" rows="15" class="input-field font-mono text-sm" readonly></textarea>
            <div class="mt-4 flex gap-4">
                <button class="btn-primary" onclick="copyToClipboard()">Copy to Clipboard</button>
                <button class="btn-primary" onclick="downloadHTML()">Download as File</button>
                <button class="btn-primary" onclick="openArticlePreview()">Preview Article</button>
            </div>
        </div>

        <!-- Instructions -->
        <div class="form-section">
            <h3 class="text-xl font-bold mb-4">How to Use This Static Admin Tool</h3>
            <div class="space-y-3 text-slate-600">
                <p><strong>1.</strong> Choose the type of content you want to add (Neuroscience, Mathematics, or Book Note)</p>
                <p><strong>2.</strong> Fill in the form with your content details</p>
                <p><strong>3.</strong> Click "Preview" to see how it will look on the website</p>
                <p><strong>4.</strong> Click "Generate HTML" to get the code</p>
                <p><strong>5.</strong> Copy the generated HTML and paste it into the appropriate section in research.html</p>
                <p><strong>6.</strong> For article content, also add the article data to article.html's static data</p>
            </div>
            
            <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                <h4 class="font-semibold text-blue-800 mb-2">Available Tags by Section:</h4>
                <div class="text-sm space-y-2">
                    <p><strong>Neuroscience:</strong> computational-neuroscience, neural-networks, memory, consciousness, learning, plasticity, review</p>
                    <p><strong>Mathematics:</strong> linear-algebra, calculus, probability, statistics, optimization, information-theory, graph-theory</p>
                </div>
            </div>
            
            <div class="mt-6 p-4 bg-green-50 rounded-lg">
                <h4 class="font-semibold text-green-800 mb-2">✨ Benefits of Static Approach:</h4>
                <div class="text-sm space-y-1">
                    <p>• No database dependencies or external services needed</p>
                    <p>• Faster loading times</p>
                    <p>• Works offline</p>
                    <p>• Easy to backup and version control</p>
                    <p>• No ongoing costs</p>
                </div>
            </div>
        </div>

    </main>

    <script>
        // Simple password protection
        const ADMIN_PASSWORD = 'snow2025'; // 请更改为您的密码
        let isAuthenticated = false;
        let currentType = 'neuroscience';

        function checkPassword() {
            const inputPassword = document.getElementById('adminPassword').value;
            const loginError = document.getElementById('loginError');
            
            if (inputPassword === ADMIN_PASSWORD) {
                isAuthenticated = true;
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                // 保存登录状态到sessionStorage (浏览器关闭后失效)
                sessionStorage.setItem('adminAuth', 'true');
            } else {
                loginError.style.display = 'block';
                document.getElementById('adminPassword').value = '';
            }
        }

        // 检查是否已经登录
        function checkAuthStatus() {
            if (sessionStorage.getItem('adminAuth') === 'true') {
                isAuthenticated = true;
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
            }
        }

        // 页面加载时检查认证状态
        window.addEventListener('load', checkAuthStatus);

        // Enter键登录
        document.getElementById('adminPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkPassword();
            }
        });

        // Tab functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentType = this.dataset.type;
                
                // Show/hide book-specific fields
                const bookFields = document.getElementById('book-fields');
                bookFields.style.display = currentType === 'book' ? 'block' : 'none';
                
                generatePreview();
            });
        });

        function generatePreview() {
            if (!isAuthenticated) return;
            const title = document.getElementById('title').value || 'Sample Title';
            const description = document.getElementById('description').value || 'Sample description text...';
            const content = document.getElementById('content').value || 'Sample content...';
            const tags = document.getElementById('tags').value || 'sample-tag';
            const imageUrl = document.getElementById('imageUrl').value;
            
            let previewHTML = '';
            
            if (currentType === 'book') {
                const author = document.getElementById('author').value || 'Author Name';
                const progress = document.getElementById('progress').value || '25';
                
                previewHTML = `
                    <div class="book-card bg-white rounded-lg p-6 shadow-lg">
                        <div class="w-full h-48 bg-gradient-to-br from-green-100 to-green-200 rounded-lg overflow-hidden mb-4">
                            ${imageUrl ? `<img src="${imageUrl}" alt="${title}" class="w-full h-full object-cover">` : 
                            `<div class="w-full h-full flex items-center justify-center">
                                <svg class="w-16 h-16 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                            </div>`}
                        </div>
                        <h3 class="text-xl font-bold text-slate-800 mb-2">${title}</h3>
                        <p class="text-sm text-slate-600 mb-2">${author}</p>
                        <p class="text-sm text-slate-500 mb-3">${description}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-slate-400">Progress: ${progress}%</span>
                            <div class="w-20 bg-gray-200 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full" style="width: ${progress}%"></div>
                            </div>
                        </div>
                    </div>`;
            } else {
                const cardClass = currentType === 'mathematics' ? 'math-article-card' : 'article-card';
                previewHTML = `
                    <div class="${cardClass} rounded-lg p-6 border border-gray-100" data-tags="${tags}">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                            <div class="flex-1">
                                <h3 class="text-2xl font-bold text-slate-800 mb-3">${title}</h3>
                                <p class="text-slate-600 mb-4 leading-relaxed">${description}</p>
                                <div class="flex items-center text-sm text-slate-500">
                                    <span>${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
                                </div>
                            </div>
                            <div class="w-full md:w-32 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg overflow-hidden">
                                ${imageUrl ? `<img src="${imageUrl}" alt="${title}" class="w-full h-full object-cover">` : 
                                `<div class="w-full h-full bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-12 h-12 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                    </svg>
                                </div>`}
                            </div>
                        </div>
                    </div>`;
            }
            
            document.getElementById('preview').innerHTML = previewHTML;
        }

        function generateCode() {
            if (!isAuthenticated) return;
            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const tags = document.getElementById('tags').value;
            const imageUrl = document.getElementById('imageUrl').value;
            
            if (!title || !description) {
                alert('Please fill in at least the title and description fields');
                return;
            }
            
            const articleId = title.toLowerCase().replace(/[^a-z0-9]/g, '-').replace(/-+/g, '-').slice(0, 50);
            const currentDate = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
            
            let code = '';
            
            if (currentType === 'book') {
                const author = document.getElementById('author').value || 'Unknown Author';
                const progress = document.getElementById('progress').value || '0';
                
                code = `                    <div class="book-card bg-white rounded-lg p-6 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer" onclick="openBookNotes('${articleId}')">
                        <div class="mb-4">
                            <div class="w-full h-48 bg-gradient-to-br from-green-100 to-green-200 rounded-lg overflow-hidden mb-4">
                                ${imageUrl ? `<img src="${imageUrl}" alt="${title}" class="w-full h-full object-cover" 
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` : ''}
                                <div class="w-full h-full bg-gradient-to-br from-green-100 to-green-200 rounded-lg flex items-center justify-center"${imageUrl ? ' style="display: none;"' : ''}>
                                    <svg class="w-16 h-16 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                    </svg>
                                </div>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">${title}</h3>
                            <p class="text-sm text-slate-600 mb-2">${author}</p>
                            <p class="text-sm text-slate-500 mb-3">${description}</p>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-slate-400">进度: ${progress}%</span>
                                <div class="w-20 bg-gray-200 rounded-full h-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: ${progress}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>`;
            } else {
                const cardClass = currentType === 'mathematics' ? 'math-article-card' : 'article-card';
                const functionName = currentType === 'mathematics' ? 'openMathArticle' : 'openArticle';
                
                code = `                    <div class="${cardClass} rounded-lg p-6 border border-gray-100" data-tags="${tags}" onclick="${functionName}('${articleId}')">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                            <div class="flex-1">
                                <h3 class="text-2xl font-bold text-slate-800 hover:text-sky-600 transition-colors mb-3">
                                    ${title}
                                </h3>
                                <p class="text-slate-600 mb-4 leading-relaxed">
                                    ${description}
                                </p>
                                <div class="flex items-center text-sm text-slate-500">
                                    <span>${currentDate}</span>
                                </div>
                            </div>
                            <div class="w-full md:w-32 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg overflow-hidden">
                                ${imageUrl ? `<img src="${imageUrl}" alt="${title}" class="w-full h-full object-cover" 
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` : ''}
                                <div class="w-full h-full bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg flex items-center justify-center"${imageUrl ? ' style="display: none;"' : ''}>
                                    <svg class="w-12 h-12 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>`;
            }
            
            document.getElementById('generated-code').value = code;
            document.getElementById('code-section').style.display = 'block';
            document.getElementById('code-section').scrollIntoView({ behavior: 'smooth' });
        }

        function copyToClipboard() {
            const codeTextarea = document.getElementById('generated-code');
            codeTextarea.select();
            document.execCommand('copy');
            alert('Code copied to clipboard!');
        }

        function downloadHTML() {
            const code = document.getElementById('generated-code').value;
            const blob = new Blob([code], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'new-content.html';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Remove Firebase save functionality - not needed for static approach
        function saveToFirebase() {
            alert('This static version doesn\'t need Firebase! Just use the "Generate HTML" feature to get your code, then copy it to your research.html file. This approach is faster, more reliable, and doesn\'t require any external services.');
        }

        // Open article preview in new tab
        function openArticlePreview() {
            const title = document.getElementById('title').value;
            if (!title) {
                alert('Please enter a title first');
                return;
            }
            
            const articleId = title.toLowerCase().replace(/[^a-z0-9]/g, '-').replace(/-+/g, '-').slice(0, 50);
            const type = currentType === 'book' ? 'book-notes' : 'article';
            const url = `article.html?id=${articleId}&type=${type}`;
            window.open(url, '_blank');
        }

        // Enhanced generate code function
        function generateCode() {
            if (!isAuthenticated) return;
            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const content = document.getElementById('content').value;
            const tags = document.getElementById('tags').value;
            const imageUrl = document.getElementById('imageUrl').value;
            
            if (!title || !description) {
                alert('Please fill in at least the title and description fields');
                return;
            }
            
            const articleId = title.toLowerCase().replace(/[^a-z0-9]/g, '-').replace(/-+/g, '-').slice(0, 50);
            const currentDate = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
            
            let code = '';
            
            if (currentType === 'book') {
                const author = document.getElementById('author').value || 'Unknown Author';
                const progress = document.getElementById('progress').value || '0';
                
                code = `                    <div class="book-card bg-white rounded-lg p-6 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer" onclick="openBookNotes('${articleId}')">
                        <div class="mb-4">
                            <div class="w-full h-48 bg-gradient-to-br from-green-100 to-green-200 rounded-lg overflow-hidden mb-4">
                                ${imageUrl ? `<img src="${imageUrl}" alt="${title}" class="w-full h-full object-cover" 
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` : ''}
                                <div class="w-full h-full bg-gradient-to-br from-green-100 to-green-200 rounded-lg flex items-center justify-center"${imageUrl ? ' style="display: none;"' : ''}>
                                    <svg class="w-16 h-16 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                    </svg>
                                </div>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">${title}</h3>
                            <p class="text-sm text-slate-600 mb-2">${author}</p>
                            <p class="text-sm text-slate-500 mb-3">${description}</p>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-slate-400">进度: ${progress}%</span>
                                <div class="w-20 bg-gray-200 rounded-full h-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: ${progress}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>`;
            } else {
                const cardClass = currentType === 'mathematics' ? 'math-article-card' : 'article-card';
                const functionName = currentType === 'mathematics' ? 'openMathArticle' : 'openArticle';
                
                code = `                    <div class="${cardClass} rounded-lg p-6 border border-gray-100" data-tags="${tags}" onclick="${functionName}('${articleId}')">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                            <div class="flex-1">
                                <h3 class="text-2xl font-bold text-slate-800 hover:text-sky-600 transition-colors mb-3">
                                    ${title}
                                </h3>
                                <p class="text-slate-600 mb-4 leading-relaxed">
                                    ${description}
                                </p>
                                <div class="flex items-center text-sm text-slate-500">
                                    <span>${currentDate}</span>
                                </div>
                            </div>
                            <div class="w-full md:w-32 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg overflow-hidden">
                                ${imageUrl ? `<img src="${imageUrl}" alt="${title}" class="w-full h-full object-cover" 
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` : ''}
                                <div class="w-full h-full bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg flex items-center justify-center"${imageUrl ? ' style="display: none;"' : ''}>
                                    <svg class="w-12 h-12 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>`;
            }
            
            document.getElementById('generated-code').value = code;
            document.getElementById('code-section').style.display = 'block';
            document.getElementById('code-section').scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize preview on page load
        generatePreview();
    </script>

</body>
</html>